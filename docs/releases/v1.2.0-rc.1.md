# Release v1.2.0-rc.1 – Phase 1 Hardening & Release-Readiness

Datum: 2025-09-11

## Highlights

- Readiness (SMTP optional)
  - `/readyz` unterstützt optionalen SMTP‑Verify, gesteuert über `READINESS_CHECK_SMTP` (boolean) und `READINESS_SMTP_TIMEOUT_MS` (ms, Default 1500).
  - `deps.smtp` signalisiert `ok` | `fail` | `skip` (skip, wenn Flag aus oder SMTP nicht konfiguriert).

- Security & Tests
  - Helmet aktiv, CORS streng über Allowlist.
  - Tests für Security‑Header (inkl. `x-dns-prefetch-control`) und CORS (Allowlist + FRONTEND_URL‑Fallback) ergänzt.

- GHCR Release Pipeline
  - Workflow `.github/workflows/docker-release.yml`: bei Tags `v*` Build & Push nach GHCR (`ghcr.io/<owner>/<repo>:<tag>` und `:latest`).
  - README enthält Release‑Runbook und Compose‑Beispiel zur Image‑Nutzung.

- Operative Checks
  - Health‑Smoke workflow (bestehend) überprüft `/healthz` & `/readyz` und lädt Artefakte hoch.
  - Discord‑Benachrichtigung (vorhandener Workflow) verlinkt auf Runs/Artefakte.

## Änderungen

- Added
  - Optionaler SMTP‑Verify in `/readyz` (Flag/Timeout), Unit‑Tests `ok/fail/skip`.
  - GHCR Release Workflow (Tags → Build & Push), README‑Runbook/Compose.
  - Verschärfte Security/CORS‑Tests.

- Changed
  - README: Table‑of‑Contents, System‑Health‑Abschnitt, GHCR‑Release‑How‑To inkl. GitHub‑Release via `release.yml`.

## Migration / ENV

- `READINESS_CHECK_SMTP` (default `false`)
- `READINESS_SMTP_TIMEOUT_MS` (default `1500`)
- (Optional) `REDIS_URL` für Rate‑Limit Store (bereits unterstützt)

Keine Breaking Changes.

## Verifikation

```bash
curl -s http://localhost:3001/healthz | jq .
curl -s http://localhost:3001/readyz  | jq .
```

## Release (GHCR & GitHub Release)

- Tag erstellen/pushen (Beispiel RC):
```bash
npm --workspace backend version 1.2.0-rc.1 --no-git-tag-version
git add backend/package.json CHANGELOG.md docs/releases/v1.2.0-rc.1.md
git commit -m "chore(release): v1.2.0-rc.1"
git tag -a v1.2.0-rc.1 -m "Release v1.2.0-rc.1"
git push origin main --tags
```

- GHCR: Images `ghcr.io/<owner>/<repo>:v1.2.0-rc.1` und `:latest` werden automatisch gebaut/geschoben.
- GitHub Release: Workflow `release.yml` erzeugt Release‑Eintrag (oder manuell über Actions → release → Run workflow mit `tag: v1.2.0-rc.1`).

## Links

- Changelog‑Eintrag: siehe `CHANGELOG.md` Abschnitt „v1.2.0-rc.1 – Phase 1 Hardening & Release-Readiness“

