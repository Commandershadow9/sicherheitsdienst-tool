# Release v1.1.1 – Health/Readiness

Datum: 2025-09-11

## Highlights

- Neu: Liveness-/Readiness-Endpunkte
  - `GET /healthz` → `{ "status": "ok" }`
  - `GET /readyz` → `{ "status": "ready"|"not-ready", deps: { db: "ok"|"fail", smtp: "ok"|"skip" } }`
  - SMTP wird standardmäßig nicht aktiv geprüft; optionaler Verify via ENV möglich (siehe unten).

- Security Hardening
  - `helmet()` aktiviert, sichere Default-Header.
  - CORS über ENV-Whitelist (`CORS_ORIGINS`; Fallback `FRONTEND_URL`/`MOBILE_APP_URL`).

- Auth Rate-Limits
  - IP-basiert für `/auth/*` (Standard 10 req/min, ENV: `RATE_LIMIT_MAX`, `RATE_LIMIT_WINDOW`).
  - Bruteforce-Schutz: pro User/Email 5/15min für `POST /auth/login`.
  - Store: Memory (Default) oder Redis (`REDIS_URL`).

- OpenAPI/Doku
  - `/healthz` und `/readyz` als interne Endpunkte (Tag `internal`, `x-internal: true`).
  - OperationIds vereinheitlicht; ungenutzte Komponenten entfernt; Beispiele korrigiert.
  - README: Abschnitt „System-Health“ (Beispiele, Probes), ENV-Beispiele ergänzt.

- CI
  - Neuer Health‑Smoke‑Job: baut, startet App kurz und prüft `/healthz`/`/readyz`.
  - Fail‑fast inkl. Log-Dump bei Fehler.

## Migration / ENV

- Optional neue ENV‑Variablen:
  - `RATE_LIMIT_MAX` (Default 10), `RATE_LIMIT_WINDOW` (Sekunden, Default 60)
  - `REDIS_URL` (nur wenn Redis für Rate‑Limits genutzt werden soll)
  - `READINESS_CHECK_SMTP` (Default false), `READINESS_SMTP_TIMEOUT_MS` (Default 1500)

Keine Breaking Changes. Endpunkte und Verhalten rückwärtskompatibel.

## Tests

- Neu: `security.rate.test.ts`, `system.health.test.ts` decken Rate‑Limits und Health/Ready ab.
- Gesamtsuite grün.

## Hinweise

- Für Kubernetes: Liveness → `/healthz`, Readiness → `/readyz` (siehe README-Beispiele).
- Für Produktionsbetrieb wird empfohlen, `CORS_ORIGINS` explizit zu setzen und Redis für Rate‑Limits zu verwenden.

