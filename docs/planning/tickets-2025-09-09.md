# Tickets – Planung 2025-09-09

Format: Priorität (P0/P1/P2) – Kurzbeschreibung – Betroffene Dateien/Module – DoD – Schätzung

1) P0 – Incidents CRUD + Listen/Filter/Export
- Dateien: `backend/src/routes/incidentRoutes.ts`, `backend/src/controllers/incidentController.ts`, `backend/src/validations/incidentValidation.ts`, Prisma-Queries; evtl. `docs/openapi.yaml` (finalisieren), Tests unter `backend/src/__tests__/incidents.*.test.ts`.
- DoD: CRUD + List/Filter laufen inkl. RBAC (ADMIN/MANAGER schreiben, AUTH lesen), 401/403/404/422 abgedeckt, CSV/XLSX-Exporte, OpenAPI deckungsgleich, CI grün.
- Aufwand: M

2) P0 – ErrorResponse Harmonisierung OpenAPI
- Dateien: `docs/openapi.yaml` (Components ErrorResponse + Beispiele), `README.md` Beispiele prüfen.
- DoD: `success:boolean` ergänzt, Beispiele passen zum Backend-Format (`code`, `message`, `errors?`), OpenAPI validate/lint ok, Smoke-Tests prüfen Shape.
- Aufwand: S

3) P1 – Request-ID Middleware + Log-Korrelation
- Dateien: `backend/src/middleware/requestId.ts`, Einbindung in `backend/src/app.ts`, Logger (`backend/src/utils/logger.ts`) anpassen, Tests.
- DoD: `X-Request-ID` wird pro Request gesetzt/weitergereicht, Logs enthalten ID, Test prüft Header/Propagation.
- Aufwand: S

4) P1 – Rate-Limit für auth/login + auth/refresh
- Dateien: `backend/src/middleware/rateLimit.ts` erweitern/instanziieren, `backend/src/routes/authRoutes.ts`, `.env.example` Doku, Tests.
- DoD: 429 inkl. `Retry-After`, ENV-Toggles/Parameter dokumentiert, Tests für enabled/disabled/window/perMin, CI grün.
- Aufwand: S

5) P1 – PrismaClient Singleton
- Dateien: `backend/src/utils/prisma.ts`, Imports in Controllern/Middleware auf Singleton umstellen.
- DoD: Einzige Prisma-Instanz verwendet, Tests laufen stabil, keine Verbindungslecks in Dev/Test.
- Aufwand: S

6) P1 – /stats erweitern (Basics)
- Dateien: `backend/src/controllers/systemController.ts`, ggf. Zähler in Middleware.
- DoD: `/api/stats` enthält Basiszähler (Requests gesamt, 4xx/5xx) und Rate-Limit-Config; README/OpenAPI angepasst.
- Aufwand: S

7) P2 – OpenAPI Fehlerbeispiele für Push/E-Mail
- Dateien: `docs/openapi.yaml` (Beispiele für 429/5xx bei Push/E-Mail), ggf. README.
- DoD: Beispiele ergänzt, Lint ok, CI grün.
- Aufwand: S

8) P2 – README Operations/Runbook
- Dateien: `README.md` (neuer Abschnitt), Verweise auf `docker-compose.yml`, Healthchecks, ENV-Matrix.
- DoD: Vollständiger Runbook-Abschnitt mit Start/Stop/Diagnose, ENV-Übersicht; Review erfolgt.
- Aufwand: S

9) P2 – 404/405 in OpenAPI dokumentieren
- Dateien: `docs/openapi.yaml` (components/responses + ggf. globales Verhalten).
- DoD: 404/405 standardisiert dokumentiert, Beispiele vorhanden, Lint ok.
- Aufwand: S

10) P2 – E-Mail Retry (einfach)
- Dateien: `backend/src/services/emailService.ts` (Retry-Mechanismus, max 1 Wiederholung), Tests.
- DoD: Retry implementiert + unit-getestet; keine Retrys bei permanenten Fehlern (z. B. 5xx mit bestimmten Codes optional).
- Aufwand: S

