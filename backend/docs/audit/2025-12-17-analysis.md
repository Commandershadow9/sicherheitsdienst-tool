Ich analysiere das Repository systematisch. Das wird einige Minuten dauern. â— 3 Explore agents finished (ctrl+o to expand) â”œâ”€ Analyze backend structure Â· 57 tool uses Â· 86.6k tokens â”‚ â¿ Done â”œâ”€ Analyze frontend structure Â· 60 tool uses Â· 75.9k tokens â”‚ â¿ Done â””â”€ Analyze infrastructure Â· 34 tool uses Â· 46.6k tokens â¿ Done â— Ich habe die drei Analysen erhalten. Jetzt konsolidiere ich alles in das geforderte Format. --- Repository-Analyse: Sicherheitsdienst-Tool Datum: 2025-12-17 Analyst: Senior Software Architect & Produktmanager Kontext: Solo-Entwicklung, 30-Tage-Ziel fÃ¼r verkaufbaren Kern --- 1. SYSTEM-MAP â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ SICHERHEITSDIENST-TOOL â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ FRONTEND (React 18) â”‚ â”‚ â”‚ â”‚ Port: 5173 (dev) / 80 (prod) â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ /features/auth/ â†’ JWT Token Management, Protected Routes â”‚ â”‚ â”‚ â”‚ /features/sites/ â†’ Objektverwaltung (GRÃ–SSTE: 1437 LOC) â”‚ â”‚ â”‚ â”‚ /features/shifts/ â†’ Schichtanzeige & Zuweisung â”‚ â”‚ â”‚ â”‚ /features/shift-planning/ â†’ DnD Matrix, Auto-Scheduling â”‚ â”‚ â”‚ â”‚ /features/dashboard/ â†’ Kritische Schichten, Genehmigungen â”‚ â”‚ â”‚ â”‚ /features/users/ â†’ Profile, Qualifikationen, Dokumente â”‚ â”‚ â”‚ â”‚ /features/customers/ â†’ Kundenverwaltung â”‚ â”‚ â”‚ â”‚ /features/absences/ â†’ Urlaub/Krankheit, KonfliktprÃ¼fung â”‚ â”‚ â”‚ â”‚ /features/incidents/ â†’ Vorfallsmeldung â”‚ â”‚ â”‚ â”‚ /features/wizard/ â†’ Multi-Step Objekt-Erstellung â”‚ â”‚ â”‚ â”‚ /features/templates/ â†’ Schicht-/Kalkulationsvorlagen â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ /lib/api.ts â†’ Axios Instance (15s timeout, CORS) â”‚ â”‚ â”‚ â”‚ /lib/toast-helpers.ts â†’ Kontextuelle Benachrichtigungen â”‚ â”‚ â”‚ â”‚ /components/ui/ â†’ Radix UI Primitives + Tailwind â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ AbhÃ¤ngigkeiten: React Query, React Router, Zod, date-fns â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ HTTP/REST â”‚ â”‚ â–¼ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ BACKEND (Express 5) â”‚ â”‚ â”‚ â”‚ Port: 3001 â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ /controllers/ (41) â†’ Request Handler, Validierung â”‚ â”‚ â”‚ â”‚ â”œâ”€ authController â†’ Login, Refresh, Logout â”‚ â”‚ â”‚ â”‚ â”œâ”€ siteController â†’ Objekt CRUD â”‚ â”‚ â”‚ â”‚ â”œâ”€ shiftController â†’ Schicht CRUD, Ersatzsuche â”‚ â”‚ â”‚ â”‚ â”œâ”€ userController â†’ User CRUD, Profile â”‚ â”‚ â”‚ â”‚ â”œâ”€ absenceController â†’ Urlaub/Krankheit â”‚ â”‚ â”‚ â”‚ â””â”€ ... â†’ 36 weitere â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ /services/ (15) â†’ Business Logic â”‚ â”‚ â”‚ â”‚ â”œâ”€ auditLogService â†’ Batch-Queue, 2s Flush â”‚ â”‚ â”‚ â”‚ â”œâ”€ replacementServiceâ†’ Scoring-Algorithmus â”‚ â”‚ â”‚ â”‚ â”œâ”€ emailService â†’ Nodemailer â”‚ â”‚ â”‚ â”‚ â””â”€ notificationServiceâ†’ FCM Push â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ /middleware/ (11) â†’ Cross-Cutting Concerns â”‚ â”‚ â”‚ â”‚ â”œâ”€ auth.ts â†’ JWT Validation â”‚ â”‚ â”‚ â”‚ â”œâ”€ rbac.ts â†’ Role-Based Access â”‚ â”‚ â”‚ â”‚ â”œâ”€ multiTenancy.ts â†’ Customer Isolation â”‚ â”‚ â”‚ â”‚ â”œâ”€ security.ts â†’ Helmet, CORS, Rate-Limit â”‚ â”‚ â”‚ â”‚ â””â”€ validate.ts â†’ Zod Schema Validation â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ /utils/ (19) â†’ Hilfsfunktionen â”‚ â”‚ â”‚ â”‚ /validations/ (10) â†’ Zod Schemas â”‚ â”‚ â”‚ â”‚ /jobs/ â†’ Cron Jobs (Cleanup, Reports) â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ AbhÃ¤ngigkeiten: Prisma, bcrypt, JWT, Helmet, Winston â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ Prisma ORM â”‚ â”‚ â–¼ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ DATENBANK (PostgreSQL) â”‚ â”‚ â”‚ â”‚ Port: 5432 â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ KERN-MODELLE (Multi-Tenant via customerId): â”‚ â”‚ â”‚ â”‚ â”œâ”€ Customer â†’ Mandant (1:N Users) â”‚ â”‚ â”‚ â”‚ â”œâ”€ User â†’ Mitarbeiter + Auth â”‚ â”‚ â”‚ â”‚ â”œâ”€ Site â†’ Objekte/AuftrÃ¤ge â”‚ â”‚ â”‚ â”‚ â”œâ”€ Shift â†’ Schichten â”‚ â”‚ â”‚ â”‚ â”œâ”€ ShiftAssignment â†’ MA â†” Schicht â”‚ â”‚ â”‚ â”‚ â”œâ”€ ObjectClearance â†’ Einarbeitung â”‚ â”‚ â”‚ â”‚ â””â”€ Absence â†’ Urlaub/Krankheit â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ ZUSATZ-MODELLE: â”‚ â”‚ â”‚ â”‚ â”œâ”€ ControlRound/Scan â†’ NFC KontrollgÃ¤nge â”‚ â”‚ â”‚ â”‚ â”œâ”€ SiteIncident â†’ Vorfallsmeldung â”‚ â”‚ â”‚ â”‚ â”œâ”€ SiteDocument â†’ Dokumentenablage â”‚ â”‚ â”‚ â”‚ â”œâ”€ EmployeeProfile â†’ PersÃ¶nliche Daten â”‚ â”‚ â”‚ â”‚ â””â”€ AuditLog â†’ Compliance â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ Schema: 1456 Zeilen, ~25 Modelle â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ INFRASTRUKTUR â”‚ â”‚ â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”‚ â”‚ Redis (6379) â†’ Rate-Limit Store, Session Cache â”‚ â”‚ â”‚ â”‚ Mailhog (8025) â†’ Email Testing (DEV ONLY!) â”‚ â”‚ â”‚ â”‚ Prometheus (9090) â†’ Metriken â”‚ â”‚ â”‚ â”‚ Grafana (3002) â†’ Dashboards â”‚ â”‚ â”‚ â”‚ Borg Backup â†’ Dokumenten-Backup (AES-256) â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Modul-AbhÃ¤ngigkeiten (kritische Pfade) | Modul | AbhÃ¤ngig von | KritikalitÃ¤t | |----------------|----------------------|------------------| | Auth | - | KRITISCH (Basis) | | Multi-Tenancy | Auth | KRITISCH | | Sites | Auth, Multi-Tenancy | HOCH | | Shifts | Sites, Users | HOCH | | Shift-Planning | Shifts, Sites | MITTEL | | Absences | Users, Shifts | MITTEL | | Dashboard | Shifts, Sites, Users | MITTEL | | Incidents | Sites | NIEDRIG | | Control-Rounds | Sites | NIEDRIG | | Templates | Sites | NIEDRIG | --- 2. RISIKO-AUDIT: TOP 10 | # | Risiko | Kategorie | Schwere | Fundstelle | Impact | |-----|------------------------------------|--------------|-------------|--------------------------------------------|-----------------------------------------------------------------------------| | 1 | Keine HTTPS/TLS | Security | ğŸ”´ KRITISCH | docs/ops/dsgvo-compliance.md | Login-Credentials, Gesundheitsdaten unverschlÃ¼sselt. DSGVO-VerstoÃŸ Art. 32. | | 2 | JWT Token in localStorage | Security | ğŸ”´ KRITISCH | frontend/features/auth/AuthProvider.tsx:24 | XSS-Angriff â†’ Token-Diebstahl â†’ Account-Ãœbernahme | | 3 | Multi-Tenancy nur App-Layer | Datenleck | ğŸ”´ KRITISCH | backend/middleware/multiTenancy.ts | Kein DB-RLS. Bei Middleware-Ausfall: Cross-Tenant-Datenzugriff | | 4 | Standard-Credentials in Produktion | Auth | ğŸ”´ KRITISCH | docker-compose.yml:10-11 | admin:admin123 fÃ¼r PostgreSQL. Jeder mit Netzwerkzugang kann DB angreifen | | 5 | JWT_SECRET mit Fallback | Auth | ğŸ”´ KRITISCH | docker-compose.yml:39 | Fallback: changeme-in-env. Token-FÃ¤lschung mÃ¶glich | | 6 | Audit-Log nur In-Memory | Datenverlust | ğŸŸ  HOCH | backend/services/auditLogService.ts | Bei Server-Crash: Bis zu 2s Audit-Daten verloren | | 7 | Keine MIME-Type Validierung | Upload | ğŸŸ  HOCH | backend/middleware/uploadDocument.ts | Nur Header-Check. Malware-Upload mÃ¶glich | | 8 | X-Forwarded-For ohne Validation | Logging | ğŸŸ  HOCH | backend/utils/audit.ts | IP-Spoofing in Audit-Logs. Forensik unzuverlÃ¤ssig | | 9 | Grafana Standard-Passwort | Monitoring | ğŸŸ  HOCH | docs/ops/monitoring-compose.yml | admin:admin. Dashboard-Zugriff fÃ¼r jeden | | 10 | Alertmanager ohne Receiver | Monitoring | ğŸŸ  HOCH | docs/ops/monitoring-compose.yml | Alerts gehen ins Nichts. Security-Events unsichtbar | DSGVO-spezifische Risiken | Risiko | Artikel | Status | |------------------------------------|--------------|----------------| | Keine VerschlÃ¼sselung in Transit | Art. 32 | âŒ VERSTOS | | AVV mit Hoster fehlt | Art. 28 | âš ï¸ AUSSTEHEND | | Right to Erasure nicht vollstÃ¤ndig | Art. 17 | âš ï¸ TEILWEISE | | DatenportabilitÃ¤t fehlt | Art. 20 | âŒ NICHT IMPL. | | Auto-LÃ¶schung inaktiver Daten | Art. 5(1)(e) | âŒ NICHT IMPL. | --- 3. TECH-DEBT BACKLOG P0 - Blocker (Muss vor Go-Live) | ID | Item | Aufwand | Beschreibung | |------|--------------------------------|---------|--------------------------------------------| | P0-1 | HTTPS/TLS aktivieren | S | Let's Encrypt + Nginx Reverse Proxy | | P0-2 | Token in HttpOnly Cookie | M | Backend: Set-Cookie, Frontend: Cookie-Auth | | P0-3 | JWT_SECRET Validierung | S | Min. 32 Zeichen, kein Fallback | | P0-4 | DB-Port schlieÃŸen | S | PostgreSQL nur intern erreichbar | | P0-5 | Standard-Credentials entfernen | S | Keine Fallback-PasswÃ¶rter | | P0-6 | Refresh-Token mit customerId | S | Multi-Tenancy in Refresh-Flow | P1 - Wichtig (Erste 2 Wochen) | ID | Item | Aufwand | Beschreibung | |------|-----------------------------|---------|--------------------------------------| | P1-1 | DB Row-Level Security | M | PostgreSQL RLS Policies pro Customer | | P1-2 | Audit-Log Persistence | M | Redis-Queue oder DB-basiert | | P1-3 | MIME-Type Magic-Bytes Check | S | file-type npm Package | | P1-4 | X-Forwarded-For Validation | S | Nur von Trusted Proxy | | P1-5 | Grafana Credentials Ã¤ndern | S | Sichere PasswÃ¶rter | | P1-6 | Alertmanager konfigurieren | S | Email/Slack Receiver | | P1-7 | console.log entfernen | S | 25 Stellen â†’ logger.* | | P1-8 | Mailhog aus Prod entfernen | S | Nur in docker-compose.dev.yml | P2 - Sollte (Erste 4 Wochen) | ID | Item | Aufwand | Beschreibung | |------|----------------------------|---------|----------------------------------| | P2-1 | TypeScript any beheben | L | 269 Backend + 187 Frontend | | P2-2 | DSGVO Right to Erasure | M | Hard-Delete oder Anonymisierung | | P2-3 | DatenportabilitÃ¤t Export | M | JSON-Export fÃ¼r User-Daten | | P2-4 | Toast-System konsolidieren | S | Dual-System â†’ toast-helpers only | | P2-5 | API Response-Format | M | Konsistent {success, data} | | P2-6 | Test-Coverage erhÃ¶hen | L | Von 3% auf 60% | | P2-7 | Container Signing | M | Cosign fÃ¼r GHCR Images | | P2-8 | Secret Scanning in CI | S | Trivy im Standard-Workflow | Aufwand-Legende: S = 1-2h, M = 4-8h, L = 16h+ --- 4. BUGS & INKONSISTENZEN | # | Typ | Fundstelle | Problem | Impact | Fix-Vorschlag | |-----|---------|--------------------------|----------------------------------------------|---------------------------------------------|----------------------------------------------| | 1 | BUG | authController.ts | Refresh-Token ohne customerId | Multi-Tenancy-Bypass nach Token-Refresh | customerId in Refresh-Payload | | 2 | BUG | multiTenancy.ts:CREATE | Nur User-Create validiert customerId | Andere Modelle ohne Tenant-Check erstellbar | Validierung fÃ¼r alle MODELS_WITH_CUSTOMER_ID | | 3 | INKONS. | frontend/lib/utils.ts | Alter Toast mit alert() | Parallel zu Sonner aktiv | Datei lÃ¶schen | | 4 | INKONS. | frontend/features/sites/ | 3 separate API-Dateien | Typ-Duplikation, schwer wartbar | Konsolidieren zu 1 Datei | | 5 | INKONS. | API Responses | Mix aus {data}, {success,data}, Array | Frontend muss raten | Backend: Einheitliches Format | | 6 | INKONS. | Shift Type | 3Ã— definiert (sites, shifts, shift-planning) | Out-of-Sync mÃ¶glich | Zentrale /types/shift.ts | | 7 | TODO | wages.ts | Feiertags-Berechnung fehlt | Lohnabrechnung unvollstÃ¤ndig | Implementieren oder Feature entfernen | | 8 | TODO | AttachmentManager.tsx | Backend-Upload nicht implementiert | Button ohne Funktion | Implementieren oder ausblenden | | 9 | BUG | ShiftsTab.tsx:151 | Type-Cast ohne Validierung | Runtime-Fehler bei ungÃ¼ltigen Daten | Proper Type-Guard | | 10 | INKONS. | Modal-Setter Typen | boolean vs | null Mix | TypeScript-Fehler | --- 5. MODULARISIERUNGSVORSCHLAG Aktuell: Monolith mit Feature-Ordnern backend/src/ â”œâ”€â”€ controllers/ (41 Dateien, stark gekoppelt) â”œâ”€â”€ services/ (15 Dateien) â”œâ”€â”€ middleware/ (11 Dateien) â””â”€â”€ routes/ (22 Dateien) Empfehlung: Domain-Driven Struktur backend/src/ â”œâ”€â”€ core/ # Geteilte Infrastruktur â”‚ â”œâ”€â”€ auth/ # JWT, Session, RBAC â”‚ â”œâ”€â”€ multi-tenancy/ # Customer Isolation â”‚ â”œâ”€â”€ audit/ # Logging, Compliance â”‚ â””â”€â”€ security/ # Helmet, Rate-Limit â”‚ â”œâ”€â”€ domains/ # Business-DomÃ¤nen â”‚ â”œâ”€â”€ sites/ # KERN: Objektverwaltung â”‚ â”‚ â”œâ”€â”€ site.controller.ts â”‚ â”‚ â”œâ”€â”€ site.service.ts â”‚ â”‚ â”œâ”€â”€ site.routes.ts â”‚ â”‚ â”œâ”€â”€ site.validation.ts â”‚ â”‚ â””â”€â”€ site.types.ts â”‚ â”‚ â”‚ â”œâ”€â”€ shifts/ # KERN: Schichtplanung â”‚ â”‚ â””â”€â”€ ... â”‚ â”‚ â”‚ â”œâ”€â”€ users/ # KERN: Mitarbeiter â”‚ â”‚ â””â”€â”€ ... â”‚ â”‚ â”‚ â”œâ”€â”€ absences/ # OPTIONAL: Urlaub â”‚ â”‚ â””â”€â”€ ... â”‚ â”‚ â”‚ â””â”€â”€ incidents/ # OPTIONAL: VorfÃ¤lle â”‚ â””â”€â”€ ... â”‚ â””â”€â”€ shared/ # Utilities â”œâ”€â”€ prisma/ â”œâ”€â”€ logger/ â””â”€â”€ email/ Warum diese Trennung? | Modul | BegrÃ¼ndung | |--------------------|-----------------------------------------------------| | core/auth | Sicherheitskritisch, muss isoliert testbar sein | | core/multi-tenancy | Single Point of Failure, eigene Tests nÃ¶tig | | domains/sites | GrÃ¶ÃŸtes Modul (41 Controller-Linien), zu komplex | | domains/shifts | Eng mit Sites gekoppelt, aber eigene Business-Logik | | shared/ | Vermeidet zirkulÃ¤re AbhÃ¤ngigkeiten | PrioritÃ¤t fÃ¼r 30-Tage-Ziel Jetzt NICHT refactoren! Die aktuelle Struktur funktioniert. Modularisierung ist Post-MVP. --- 6. PRODUKT-FOKUS ğŸŸ¢ KERN (Verkaufbar - Must Have) | Feature | Status | BegrÃ¼ndung | |---------------------|----------------|--------------------------| | Login/Auth | âœ… Funktional | Basis fÃ¼r alles | | Multi-Tenancy | âš ï¸ Fixes nÃ¶tig | Ohne Isolation kein SaaS | | Objekte verwalten | âœ… Funktional | Kern-EntitÃ¤t | | Schichten erstellen | âœ… Funktional | Hauptnutzen | | MA zuweisen | âœ… Funktional | Schichtplanung | | Clearances | âœ… Funktional | Einarbeitung tracken | | Dashboard | âœ… Funktional | Ãœbersicht fÃ¼r Manager | ğŸŸ¡ OPTIONAL (Nice to Have - Phase 2) | Feature | Status | BegrÃ¼ndung | |---------------------|------------------|--------------------------------| | Urlaubsverwaltung | âœ… Funktional | Hilfreich, aber nicht kritisch | | Ersatz-Scoring | âœ… Funktional | Intelligente VorschlÃ¤ge | | CSV/Excel Export | âœ… Funktional | Reporting | | Dokumente hochladen | âš ï¸ UnvollstÃ¤ndig | Attachment-Upload fehlt | | Push-Notifications | âœ… Funktional | Mobile-App Voraussetzung | ğŸŸ  SPÃ„TER (Phase 3+) | Feature | Status | BegrÃ¼ndung | |----------------------|-------------------|--------------------------| | NFC KontrollgÃ¤nge | âš ï¸ Teilweise | Hardware-AbhÃ¤ngigkeit | | Vorfallsmeldung | âœ… Funktional | Erweiterung | | Kalkulation/Angebote | âš ï¸ Komplex | Viel Customization nÃ¶tig | | Sicherheitskonzept | âŒ Auskommentiert | Model nicht migriert | | Wizard | âœ… Funktional | UX-Verbesserung | ğŸ”´ RAUS (Entfernen oder Verstecken) | Feature | BegrÃ¼ndung | |---------------------------|-------------------------------------------------------| | SecurityConcept Model | Auskommentiert seit Monaten, Controller umgeschrieben | | Mailhog in Prod | Testing-Tool, nicht fÃ¼r Production | | Lohnabrechnung (wages.ts) | TODO: Feiertage fehlt, unvollstÃ¤ndig | | Template-Wizard | Zu komplex fÃ¼r MVP | --- 7. 30-TAGE-PLAN Woche 1: Security-Hardening (KRITISCH) | Tag | Task | DoD | Aufwand | |-----|-----------------------------------------------|-------------------------------------|---------| | 1 | HTTPS aktivieren (Let's Encrypt + Nginx) | curl -I https://domain.de gibt 200 | 4h | | 1 | PostgreSQL Port schlieÃŸen (nur Docker-intern) | nmap -p 5432 host â†’ filtered | 1h | | 2 | JWT_SECRET ohne Fallback, min 32 Zeichen | App startet nicht ohne Secret | 2h | | 2 | Token in HttpOnly Cookie (Backend) | Set-Cookie Header in Login-Response | 4h | | 3 | Token in HttpOnly Cookie (Frontend) | localStorage-Code entfernt | 4h | | 3 | Refresh-Token mit customerId | JWT Payload enthÃ¤lt customerId | 2h | | 4 | Multi-Tenancy: CREATE Validation alle Models | Unit-Test fÃ¼r jedes Model | 4h | | 5 | Audit-Log: Redis-Queue oder Sync-Write | Crash-Test: Keine Log-Verluste | 4h | Definition of Done Woche 1: - HTTPS funktioniert - Tokens nicht mehr in localStorage - PostgreSQL nicht von auÃŸen erreichbar - Audit-Log crash-sicher --- Woche 2: StabilitÃ¤t & DSGVO | Tag | Task | DoD | Aufwand | |-----|------------------------------------------|---------------------------------------|---------| | 6 | MIME-Type Magic-Bytes Check | Upload von .exe als .pdf schlÃ¤gt fehl | 3h | | 6 | X-Forwarded-For nur von Trusted Proxy | Unit-Test mit gespooftem Header | 2h | | 7 | Grafana/Alertmanager Credentials | Login mit Default-PW scheitert | 1h | | 7 | Alertmanager: Email-Receiver | Test-Alert kommt per Email | 2h | | 8 | AVV mit Hoster abschlieÃŸen | Unterschriebenes Dokument | 2h | | 8 | DSGVO: Right to Erasure Endpoint | DELETE /users/:id/erase funktioniert | 4h | | 9 | console.log â†’ logger.* (25 Stellen) | grep console.log gibt 0 | 2h | | 10 | Mailhog aus docker-compose.yml entfernen | Prod-Compose hat kein Mailhog | 1h | Definition of Done Woche 2: - Uploads werden auf Inhalt geprÃ¼ft - Alerts kommen per Email - AVV unterschrieben - User kÃ¶nnen sich selbst lÃ¶schen lassen --- Woche 3: Code-QualitÃ¤t & Tests | Tag | Task | DoD | Aufwand | |-----|-------------------------------------------------|-------------------------------------|---------| | 11 | TypeScript any â†’ Proper Types (Backend Top 50) | any Count < 220 | 4h | | 12 | TypeScript any â†’ Proper Types (Frontend Top 50) | any Count < 140 | 4h | | 13 | Toast-System konsolidieren | lib/utils.ts Toast-Code entfernt | 2h | | 13 | API Response-Format standardisieren | Alle Endpoints: {success, data} | 4h | | 14 | Integration-Tests: Auth-Flow | Login â†’ Refresh â†’ Logout getestet | 4h | | 15 | Integration-Tests: Multi-Tenancy | Tenant A sieht Tenant B Daten nicht | 4h | Definition of Done Woche 3: - Weniger any Types - Ein Toast-System - Kritische Flows getestet --- Woche 4: Polish & Release | Tag | Task | DoD | Aufwand | |-----|-------------------------------------|----------------------------------------|---------| | 16 | Container Signing (Cosign) | cosign verify erfolgreich | 3h | | 16 | Secret Scanning in CI | Trivy findet Test-Secret | 2h | | 17 | Backup-Test: Restore durchfÃ¼hren | DB wiederhergestellt, App funktioniert | 4h | | 18 | Load-Test: 50 concurrent Users | Response < 500ms P95 | 4h | | 19 | Dokumentation: README aktualisieren | Setup-Anleitung vollstÃ¤ndig | 2h | | 19 | Dokumentation: API-Endpoints | OpenAPI Spec aktuell | 2h | | 20 | Release v1.0.0 | Tag erstellt, Docker-Image gepusht | 2h | Definition of Done Woche 4: - Container signiert - Backup getestet - Performance akzeptabel - Dokumentation vollstÃ¤ndig - Release v1.0.0 erstellt --- Release-Checkliste PRE-RELEASE (1 Tag vorher) â–¡ Alle P0-Items abgeschlossen â–¡ Keine kritischen Bugs offen â–¡ HTTPS funktioniert â–¡ Tokens in Cookies â–¡ Multi-Tenancy getestet â–¡ Backup getestet â–¡ Monitoring funktioniert RELEASE-DAY â–¡ Git Tag erstellen (v1.0.0) â–¡ Docker Image bauen & pushen â–¡ Container scannen (Trivy) â–¡ Container signieren (Cosign) â–¡ CHANGELOG aktualisieren â–¡ GitHub Release erstellen POST-RELEASE â–¡ Smoke-Test in Production â–¡ Monitoring-Dashboard prÃ¼fen â–¡ Erster Login erfolgreich â–¡ Alerts konfiguriert --- Test-Checkliste (Minimum fÃ¼r v1.0) SECURITY â–¡ Login mit falschen Credentials â†’ 401 â–¡ Abgelaufener Token â†’ 401 â†’ Refresh â†’ Neuer Token â–¡ Tenant A kann Tenant B Daten nicht sehen â–¡ Rate-Limit: 6. Login-Versuch â†’ 429 â–¡ Upload von .exe als .pdf â†’ Abgelehnt â–¡ SQL-Injection in Suchfeld â†’ Kein Effekt KERN-FEATURES â–¡ Objekt erstellen â–¡ Schicht erstellen â–¡ MA zuweisen â–¡ Clearance vergeben â–¡ Dashboard zeigt Daten â–¡ CSV-Export funktioniert EDGE-CASES â–¡ Leere Datenbank â†’ Kein Crash â–¡ 1000 Schichten â†’ Performance OK â–¡ Gleichzeitige Zuweisung â†’ Kein Konflikt â–¡ Server-Neustart â†’ Session erhalten (Cookies) --- FAZIT Realistisch in 30 Tagen erreichbar: Ein stabiler, sicherer Kern mit: - Objektverwaltung - Schichtplanung - MA-Zuweisung - Dashboard Nicht erreichbar: Volle DSGVO-Compliance, 60% Test-Coverage, vollstÃ¤ndige Modularisierung Empfehlung: Fokus auf Woche 1-2 (Security). Woche 3-4 nur wenn Zeit. Der Code funktioniert - das Problem ist Security, nicht Features.